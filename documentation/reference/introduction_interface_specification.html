
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Introduction &#8212; AMUSE 11.0 documentation</title>
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Stellar Dynamics Interface Definition" href="stellar_dynamics_interface_specification.html" />
    <link rel="prev" title="Interface Specifications" href="interface_specification.html" />
     
    <link rel="stylesheet" href="../_static/default.css" type="text/css">

  </head><body>
    <div id="banner">
      <div id="header" py:choose="">
        <h1><a href="/">Amuse</a></h1>
      </div>
      <div style="clear:both"></div>
    </div>
    <div class="nav" id="mainnav">
    <ul>
      <li class="first"><a href="/wiki">Wiki</a>
    </ul>
    </div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a></li>
        <li class="right" >
          <a href="stellar_dynamics_interface_specification.html" title="Stellar Dynamics Interface Definition"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="interface_specification.html" title="Interface Specifications"
             accesskey="P">previous</a></li>
    <li><a href="http://www.amusecode.org">Project Homepage</a> &raquo;</li>
    
        <li class="nav-item nav-item-0"><a href="../index.html">AMUSE 11.0 documentation</a></li>

          <li class="nav-item nav-item-1"><a href="index.html" >Reference documentation</a></li>
          <li class="nav-item nav-item-2"><a href="interface_specification.html" accesskey="U">Interface Specifications</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<p>In this document we will specify the low-level interfaces of the comminity codes.
These interfaces should follow a pattern. This pattern is described bellow. This
pattern can be used to keep the interfaces of the codes consistent
between codes of different physical domains and to help in learning about
the functionality of the interfaces. In later chapters we define the specific
interfaces for the modules of different physical domains. The actual interface of
a code should derive from these interfaces.</p>
<p>These interfaces only specify the low-level interfaces. The low-level interfaces
do not support unit handling, data conversion and attributes. This functionality
is handled by the next-level interfaces described in <a href="#id1"><span class="problematic" id="id2">nextlevel_</span></a>.</p>
<div class="section" id="data-types">
<h2>Data Types<a class="headerlink" href="#data-types" title="Permalink to this headline">¶</a></h2>
<p>The exact size (in bytes) and type of the values sent between the python
layer and the community codes is very important. In this document we will
specify the type of each argument and return value.
Currently AMUSE supports 4 types, these are described in the following table.</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="16%" />
<col width="32%" />
<col width="32%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Type name</th>
<th class="head">Size</th>
<th class="head">Fortran</th>
<th class="head">C</th>
</tr>
<tr class="row-even"><th class="head"></th>
<th class="head">bytes</th>
<th class="head">type</th>
<th class="head">type</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-odd"><td>int32</td>
<td>4</td>
<td>integer</td>
<td>long</td>
</tr>
<tr class="row-even"><td>float64</td>
<td>8</td>
<td>double precision</td>
<td>double</td>
</tr>
<tr class="row-odd"><td>float32</td>
<td>4</td>
<td>real</td>
<td>float</td>
</tr>
<tr class="row-even"><td>string</td>
<td>n</td>
<td>&#160;</td>
<td>char *</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="function-template">
<h2>Function template<a class="headerlink" href="#function-template" title="Permalink to this headline">¶</a></h2>
<p>All functions in the interface should follow the same template.
Each function returns an error or status code. Results are returned through
the function arguments. In C these arguments need to be pointers
to valid memory locations.</p>
<dl class="class">
<dt id="amuse.community.interface.example.ExampleInterface">
<em class="property">class </em><code class="descclassname">amuse.community.interface.example.</code><code class="descname">ExampleInterface</code><a class="headerlink" href="#amuse.community.interface.example.ExampleInterface" title="Permalink to this definition">¶</a></dt>
<dd><dl class="attribute">
<dt id="amuse.community.interface.example.ExampleInterface.example_function">
<code class="descname">example_function</code><a class="headerlink" href="#amuse.community.interface.example.ExampleInterface.example_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Example template for the other functions defined in this 
specification. All functions should follow this example..</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">int32</span> <span class="nf">example_function</span><span class="p">(</span><span class="n">int32</span> <span class="n">input</span><span class="p">,</span> <span class="n">float64</span> <span class="o">*</span> <span class="n">output</span><span class="p">,</span> <span class="n">float64</span> <span class="o">*</span> <span class="n">inout</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="k">FUNCTION </span><span class="n">example_function</span><span class="p">(</span><span class="n">input</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">inout</span><span class="p">)</span>
  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">input</span>
  <span class="kt">DOUBLE PRECISION</span> <span class="kd">::</span> <span class="n">output</span><span class="p">,</span> <span class="n">inout</span>
  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">example_function</span>
<span class="k">END FUNCTION</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>input</strong> (<em>int32</em><em>, </em><em>IN</em>) – Typical input parameter, the argument is passed by value to the function.</li>
<li><strong>output</strong> (<em>float64</em><em>, </em><em>OUT</em>) – Typical output parameter, the argument is passed by reference.
The argument should point to a valid memory location.</li>
<li><strong>inout</strong> (<em>float64</em><em>, </em><em>INOUT</em>) – Some arguments can be both input as well as output. The function will
update the value of the passed argument.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Function will return an error code.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<p>The error codes all have the same general form. Zero stands for no error, a negative
value indicates some error happened, a positive value is returned when the function
ends in a special state.</p>
<dl class="docutils">
<dt>0 - OK</dt>
<dd>Function encountered no error or special state</dd>
<dt>&lt;0 - ERROR</dt>
<dd>Something went wrong in the execution of the function</dd>
<dt>&gt;0 - STATE</dt>
<dd>Function has encountered an expected special state. For example the code
has detected a collision between two stars.</dd>
</dl>
</div>
<div class="section" id="function-categories">
<h2>Function categories<a class="headerlink" href="#function-categories" title="Permalink to this headline">¶</a></h2>
<div class="section" id="parameters">
<h3>Parameters<a class="headerlink" href="#parameters" title="Permalink to this headline">¶</a></h3>
<p>Codes can have a number of parameters. Some parameters are domain specific, these
parameters are found for all codes in a specific domain (for example the smoothing
length in gravitational dynamics). Other parameters are only defined and used by
a specific code. The domain specific parameters are defined on the domain specific
interfaces, when a code supports the parameter it should implement the
specified functions. Other parameters have to be accessed with functions following
the template of the <code class="xref py py-meth docutils literal notranslate"><span class="pre">get_example_parameter()</span></code>
and <a class="reference internal" href="#amuse.community.interface.example.ExampleInterface.set_example_parameter" title="amuse.community.interface.example.ExampleInterface.set_example_parameter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_example_parameter()</span></code></a> functions.</p>
<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">amuse.community.interface.example.</code><code class="descname">ExampleInterface</code></dt>
<dd><dl class="attribute">
<dt id="amuse.community.interface.example.ExampleInterface.get_example_parameter">
<code class="descname">get_example_parameter</code><a class="headerlink" href="#amuse.community.interface.example.ExampleInterface.get_example_parameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve the current value of the parameter. Note, values can be any
of the supported types.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">int32</span> <span class="nf">get_example_parameter</span><span class="p">(</span><span class="n">float64</span> <span class="o">*</span> <span class="n">value</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="k">FUNCTION </span><span class="n">get_example_parameter</span><span class="p">(</span><span class="k">value</span><span class="p">)</span>
  <span class="kt">DOUBLE PRECISION</span> <span class="kd">::</span> <span class="k">value</span>
<span class="k">  </span><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">get_example_parameter</span>
<span class="k">END FUNCTION</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>value</strong> (<em>float64</em><em>, </em><em>OUT</em>) – The current value of the parameter.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="docutils">
<dt>0 - OK</dt>
<dd>Current value was retrieved</dd>
<dt>-1 - ERROR</dt>
<dd>The code does not have support for this parameter, use this when
a code does not support a parameter pre-defined in a physical domain</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="amuse.community.interface.example.ExampleInterface.set_example_parameter">
<code class="descname">set_example_parameter</code><a class="headerlink" href="#amuse.community.interface.example.ExampleInterface.set_example_parameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the value of the parameter. The type of the new value argument
must be the same as the <a class="reference internal" href="#amuse.community.interface.example.ExampleInterface.get_example_parameter" title="amuse.community.interface.example.ExampleInterface.get_example_parameter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_example_parameter()</span></code></a> function.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">int32</span> <span class="nf">set_example_parameter</span><span class="p">(</span><span class="n">float64</span> <span class="n">value</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="k">FUNCTION </span><span class="n">set_example_parameter</span><span class="p">(</span><span class="k">value</span><span class="p">)</span>
  <span class="kt">DOUBLE PRECISION</span> <span class="kd">::</span> <span class="k">value</span>
<span class="k">  </span><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">set_example_parameter</span>
<span class="k">END FUNCTION</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>value</strong> (<em>float64</em><em>, </em><em>IN</em>) – The new value of the parameter.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="docutils">
<dt>0 - OK</dt>
<dd>New value of the parameter was set</dd>
<dt>-1 - ERROR</dt>
<dd>The code does not have support for this parameter</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<p>A function used to access (set or get) a parameter may only retrieve
or update the value of a single parameter. Functions setting two or more
parameters in one go are not supported by the next-level interfaces. After all
parameters have been set, the  <a class="reference internal" href="#amuse.community.interface.example.ExampleInterface.initialize_code" title="amuse.community.interface.example.ExampleInterface.initialize_code"><code class="xref py py-meth docutils literal notranslate"><span class="pre">initialize_code()</span></code></a>
function should be called, this gives the code the opportunity prepare the model.</p>
<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">amuse.community.interface.example.</code><code class="descname">ExampleInterface</code></dt>
<dd><dl class="attribute">
<dt id="amuse.community.interface.example.ExampleInterface.initialize_code">
<code class="descname">initialize_code</code><a class="headerlink" href="#amuse.community.interface.example.ExampleInterface.initialize_code" title="Permalink to this definition">¶</a></dt>
<dd><p>Let the code perform initialization actions after all parameters have been set.
Should be called once per running code instance.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">int32</span> <span class="nf">initialize_code</span><span class="p">();</span>
</pre></div>
</div>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="k">FUNCTION </span><span class="n">initialize_code</span><span class="p">()</span>
  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">initialize_code</span>
<span class="k">END FUNCTION</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><dl class="docutils">
<dt>0 - OK</dt>
<dd>Code is initialized</dd>
<dt>-1 - ERROR</dt>
<dd>Error happened during initialization, this error needs to be further specified by every code implemention</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="object-management">
<h3>Object Management<a class="headerlink" href="#object-management" title="Permalink to this headline">¶</a></h3>
<p>Codes can work on particles or grids (stars, black holes or gas). The methods
in the <em>Object Management</em> category define the functionality to create, remove
and query the particles or gridpoints in the codes.</p>
<p>When a code supports objects, the code is responsible for managing these objects.
The code needs to assign a unique index to a particle so that the particle can be
referred to in other function calls. This is a <em>major</em> difference with the
<code class="docutils literal notranslate"><span class="pre">MUSE</span></code> code. Where the user of the code was responsible for assigning unique ids
to the particles. This change makes the implementation of the code simpler and
allows the code to support creation of new objects during simulation. For example
a hydrocode can add or delete gridpoints during the evolution of the model.</p>
</div>
<div class="section" id="object-state">
<h3>Object state<a class="headerlink" href="#object-state" title="Permalink to this headline">¶</a></h3>
<p>Particles in the same physical domain can have a well known, <em>minimal</em> state.
For example, in the gravitational dynamics domain the state of a particle can be
defined by a location vector, velocity vector, a mass and a radius. The methods
in the <em>Object State</em> category provide a way to access this state in one function.</p>
</div>
<div class="section" id="object-state-extension-mechanism">
<h3>Object State, Extension Mechanism<a class="headerlink" href="#object-state-extension-mechanism" title="Permalink to this headline">¶</a></h3>
<p>Not all information of a particle can be transfered with the get_state
and set_state functions. Some codes may support other properties of a particle,
the code can define <code class="docutils literal notranslate"><span class="pre">get_</span></code> and <code class="docutils literal notranslate"><span class="pre">set_</span></code> functions for these properties. These
functions follow the pattern defined in the <em>Parameters</em> category. The functions
must either get or set a scalar property (1 argument) or
a vector property (3 arguments).</p>
</div>
<div class="section" id="model-evolution">
<h3>Model evolution<a class="headerlink" href="#model-evolution" title="Permalink to this headline">¶</a></h3>
<p>The main function of a code is often evolving a model in time or solving a steady
state solution. The methods that control model evolution or start and stop the
model calculations all belong to the <em>Model evolution</em> category. At this time,
no pattern is defined for the functions in this category.</p>
</div>
<div class="section" id="diagnostics">
<h3>Diagnostics<a class="headerlink" href="#diagnostics" title="Permalink to this headline">¶</a></h3>
<p>The state of the code can be queried, before, during and after the model
calculations. All the functions in this category follow
the ‘get_name’ pattern. The state of code should not change during a function
call to a function in this category. The functions must either get
a scalar property (1 argument) or a vector property (3 arguments).</p>
</div>
<div class="section" id="services">
<h3>Services<a class="headerlink" href="#services" title="Permalink to this headline">¶</a></h3>
<p>Some codes can provide services for other codes in the same or other physical
domains. For example, gravitational dynamics code might provide a function to
calculate the gravity force at a point. The methods that provide these
services all belong to this category.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Introduction</a><ul>
<li><a class="reference internal" href="#data-types">Data Types</a></li>
<li><a class="reference internal" href="#function-template">Function template</a></li>
<li><a class="reference internal" href="#function-categories">Function categories</a><ul>
<li><a class="reference internal" href="#parameters">Parameters</a></li>
<li><a class="reference internal" href="#object-management">Object Management</a></li>
<li><a class="reference internal" href="#object-state">Object state</a></li>
<li><a class="reference internal" href="#object-state-extension-mechanism">Object State, Extension Mechanism</a></li>
<li><a class="reference internal" href="#model-evolution">Model evolution</a></li>
<li><a class="reference internal" href="#diagnostics">Diagnostics</a></li>
<li><a class="reference internal" href="#services">Services</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="interface_specification.html"
                        title="previous chapter">Interface Specifications</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="stellar_dynamics_interface_specification.html"
                        title="next chapter">Stellar Dynamics Interface Definition</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/reference/introduction_interface_specification.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a></li>
        <li class="right" >
          <a href="stellar_dynamics_interface_specification.html" title="Stellar Dynamics Interface Definition"
             >next</a></li>
        <li class="right" >
          <a href="interface_specification.html" title="Interface Specifications"
             >previous</a></li>
    <li><a href="http://www.amusecode.org">Project Homepage</a> &raquo;</li>
    
        <li class="nav-item nav-item-0"><a href="../index.html">AMUSE 11.0 documentation</a></li>

          <li class="nav-item nav-item-1"><a href="index.html" >Reference documentation</a></li>
          <li class="nav-item nav-item-2"><a href="interface_specification.html" >Interface Specifications</a></li> 
      </ul>
    </div>
    <!-- Piwik -->
<script type="text/javascript">
var pkBaseURL = (("https:" == document.location.protocol) ? "https://stats.amusecode.org/" : "http://stats.amusecode.org/");
document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
</script><script type="text/javascript">
try {
var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 1);
piwikTracker.trackPageView();
piwikTracker.enableLinkTracking();
} catch( err ) {}
</script><noscript><p><img src="http://stats.amusecode.org/piwik.php?idsite=1" style="border:0" alt="" /></p></noscript>
<!-- End Piwik Tracking Code -->

    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2009-2016 The AMUSE Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.3.
    </div>

  </body>
</html>